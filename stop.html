<!DOCTYPE html>
<html>

<head>
    <title>Stop</title>
    <meta name="viewport" content="width=device-width; initial-scale=1.0">
    <link rel="stylesheet" style="text/css" href="stop.css" />
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!--firebase-->
    <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
    <!--Google Analytics-->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-121084620-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-121084620-1');
    </script>
</head>
<script>

// Initialize Firebase
var config = {
    apiKey: "AIzaSyBqaB_5x6WNZiU5RoSZ4aveLmuMgfs0m_0",
    authDomain: "viban-44f1e.firebaseapp.com",
    databaseURL: "https://viban-44f1e.firebaseio.com",
    projectId: "viban-44f1e",
    storageBucket: "viban-44f1e.appspot.com",
    messagingSenderId: "150917914821"
};
firebase.initializeApp(config);
var dbRef = firebase.database();
// var playerRef = dbRef.ref('viban');
// login with facebook
var provider = new firebase.auth.FacebookAuthProvider();
function facebookSignin() {
    firebase.auth().signInWithRedirect(provider).then(function(result) {
        var token = result.credential.accessToken;
        var user = result.user;
        console.log(user);
    }).catch(function(error) {
        console.log(error.code);
        console.log(error.message);
    });
}
function facebookSignout() {
    firebase.auth().signOut().then(function() {
        console.log('Signout successful!')
    }, function(error) {
        console.log('Signout failed')
    });
}

dbRef.ref().once('value').then(function(snapshot) {
    snapshot.forEach(function(childsnapshot) {
        console.log(childsnapshot.val());
    })
})
// dbRef.once('value').then(function(snapshot) {
//     console.log(snapshot);
// })
// read information
// var dbRef = firebase.database();
// var playerRef = dbRef.ref('viban');
    function myFunction() {
    firebase.auth().getRedirectResult().then(function(result) {
        var user = result.user;
        var a =10;
   dbRef.ref(user.uid).once('value').then(function(snapshot) {
       var rubyamount=snapshot.val().ruby;
       if(rubyamount>=10){
           document.getElementById("dig").innerHTML ="<button type="button" onclick="window.location.href='index.html'">合成寶石</button>"
       }
    });
    });
}
// function writeUserData() {
//     firebase.auth().getRedirectResult().then(function(result) {
//         var user = result.user;
//         var a =10;
//    dbRef.ref(user.uid).update({
//         time: 0,
//        digTime:0,
//         ruby: 30-a
//     });
//     });
// }
//cookie
// var decodedCookie = decodeURIComponent(document.cookie);
// console.log(decodedCookie);
// playerRef.once('value').then(function(snapshot) {
//     snapshot.forEach(function(childSnapshot) {
//         if (decodedCookie == childSnapshot.val().name) {
//             var current = childSnapshot.key;
//             console.log(current);
//             playerRef.child(current).set({
//                 name: decodedCookie,
//                 ruby: 14,
//                 time: 6,
//                 coupon: 3
//             });
//         }
//         if (decodedCookie != childSnapshot.val().name) {
//             var current = playerRef.push({
//                 name: decodedCookie,
//                 ruby: 1,
//                 time: 1,
//                 coupon: 1
//             }).key;
//         }
//     });
// })
</script>

<body onload="myFunction()">
    <div class="contain">
        <div class="timeDuration" style="padding-left: 40%; padding-top: 18%;font-size: 15px">
        </div>
        <div id="dig">
        
            <div>
    </div>
</body>

</html>
